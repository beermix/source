diff -Naur linux-4.14.90-orig/arch/x86/Makefile linux-4.14.90/arch/x86/Makefile
--- linux-4.14.90-orig/arch/x86/Makefile	2018-12-27 03:20:05.482622037 +0300
+++ linux-4.14.90/arch/x86/Makefile	2018-12-27 03:19:32.809289400 +0300
@@ -274,7 +274,7 @@
 
 # Avoid indirect branches in kernel to deal with Spectre
 ifdef CONFIG_RETPOLINE
-  KBUILD_CFLAGS += $(RETPOLINE_CFLAGS)
+  KBUILD_CFLAGS += $(RETPOLINE_CFLAGS) -mzero-caller-saved-regs=used
 endif
 
 archscripts: scripts_basic
